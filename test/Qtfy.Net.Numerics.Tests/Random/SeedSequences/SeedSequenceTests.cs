// <copyright file="SeedSequenceTests.cs" company="QuantifEye">
// Copyright (c) QuantifEye. All rights reserved.
// Licensed under the Apache 2.0 license.
// See LICENSE.txt file in the project root for full license information.
// </copyright>

namespace Qtfy.Net.Numerics.Tests.Random.SeedSequences
{
    using System;
    using System.Collections;
    using System.Diagnostics.CodeAnalysis;
    using System.Linq;
    using NUnit.Framework;
    using Qtfy.Net.Numerics.Random.SeedSequences;

    public class SeedSequenceTests
    {
        [TestCaseSource(typeof(UIntCases))]
        public void TestUIntGenerate(uint[] seeds, uint[] expectedUInts)
        {
            var actualUInts = new uint[expectedUInts.Length];
            new SeedSequence(seeds).Generate(actualUInts);
            Assert.AreEqual(expectedUInts, actualUInts);
        }

        [Test]
        public void TestConstructWithNull()
        {
            Assert.Throws<ArgumentNullException>(
                () => _ = new SeedSequence(null));
        }

        [Test]
        public void TestGenerateWithNull()
        {
            Assert.Throws<ArgumentNullException>(
                () => new SeedSequence(1).Generate((uint[])null));

            Assert.Throws<ArgumentNullException>(
                () => new SeedSequence(1).Generate((ulong[])null));
        }

        [Test]
        public void TestConstructWithEmpty()
        {
            Assert.Throws<ArgumentException>(
                () => _ = new SeedSequence(Enumerable.Empty<uint>()));
        }

        [SuppressMessage("Microsoft.Performance", "CA1812", Justification = "class is instantiated by unit testing")]
        private class UIntCases : IEnumerable
        {
            private static object[] Case(uint[] seeds, uint[] expected)
                => new object[] { seeds, expected };

            public IEnumerator GetEnumerator()
            {
                uint[] seeds = { 1, 2, 3 };
                yield return Case(
                    seeds,
                    new[]
                    {
                        4199328558U,
                    });
                yield return Case(
                    seeds,
                    new[]
                    {
                        3939532434U,
                        371658657U,
                        1749777053U,
                    });
                yield return Case(
                    seeds,
                    new[]
                    {
                        1988925043U,
                        1913857364U,
                        2377960491U,
                        1209576660U,
                        3438231549U,
                        925516315U,
                        2053144686U,
                    });
                yield return Case(
                    seeds,
                    new[]
                    {
                        1552371058U,
                        3938875816U,
                        2366183820U,
                        2350467775U,
                        891231060U,
                        3023091537U,
                        3506567640U,
                        3030419463U,
                        3273846472U,
                        3160929292U,
                        3197219885U,
                        2443374594U,
                        2902294659U,
                        341744254U,
                        1677652949U,
                        3137665916U,
                        4079207797U,
                        2771249167U,
                        2760947822U,
                        408287210U,
                        1630482152U,
                        1025941301U,
                        3687274533U,
                        225251236U,
                        3547974824U,
                        3235401369U,
                        3864535752U,
                        793467686U,
                        304223470U,
                        3629329647U,
                        4022145595U,
                        795127233U,
                        2880837945U,
                        703212279U,
                        1911150000U,
                        1565248773U,
                        3526265425U,
                        2681077810U,
                        1133658689U,
                    });
                yield return Case(
                    seeds,
                    new[]
                    {
                        616987677U,
                        417464922U,
                        3472740373U,
                        1961310511U,
                        3255520401U,
                        3950113833U,
                        1698910543U,
                        1387999895U,
                        1141961648U,
                        2854411300U,
                        3226613184U,
                        2478352880U,
                        1761148661U,
                        1365580970U,
                        3361771373U,
                        440414444U,
                        1472621810U,
                        2675327971U,
                        3504183749U,
                        2885520376U,
                        2612103313U,
                        2332540513U,
                        749005574U,
                        564683600U,
                        158706065U,
                        1048887789U,
                        3579710517U,
                        534728587U,
                        210197625U,
                        2760261218U,
                        795625919U,
                        3720330130U,
                        2219336351U,
                        1806319511U,
                        1933898650U,
                        809002688U,
                        2073388696U,
                        2544643055U,
                        1692793619U,
                        1839753619U,
                        566348846U,
                        2344294291U,
                        4059997277U,
                        3324756300U,
                        4174705228U,
                        2814204986U,
                        2821956119U,
                        1628233029U,
                        2962976868U,
                        3782448467U,
                        3787231523U,
                        170713781U,
                        735910997U,
                        337199498U,
                        3776879540U,
                        1615613345U,
                        3373265247U,
                        1082811413U,
                        1465464887U,
                        2779457340U,
                        723835445U,
                        982151035U,
                        889358530U,
                        2266673020U,
                        296177092U,
                        494484171U,
                        813689705U,
                        895530153U,
                    });

                yield return Case(
                    seeds,
                    new[]
                    {
                        4148000480U,
                        2364719997U,
                        2382763130U,
                        1537875171U,
                        369930120U,
                        1085899239U,
                        3188523554U,
                        1493269083U,
                        3752855298U,
                        1748622659U,
                        1037306955U,
                        557762704U,
                        2790852495U,
                        600091813U,
                        2658608862U,
                        204980296U,
                        4132573721U,
                        409931421U,
                        2902120234U,
                        1271974984U,
                        188967209U,
                        3439019473U,
                        685917789U,
                        1861435754U,
                        2140788961U,
                        2421241216U,
                        3934904066U,
                        402283993U,
                        369587470U,
                        2458666211U,
                        216388143U,
                        3814791430U,
                        1986169617U,
                        4214297415U,
                        2665895792U,
                        4052883671U,
                        1565065316U,
                        1740140941U,
                        1850580674U,
                        1300696350U,
                        190583361U,
                        3571995708U,
                        85084233U,
                        731197356U,
                        3320282983U,
                        1649802758U,
                        2619609249U,
                        2694666989U,
                        1635997332U,
                        1102676319U,
                        1427096863U,
                        3981338794U,
                        314448442U,
                        120548166U,
                        3647677754U,
                        3018199076U,
                        2845001426U,
                        1391536092U,
                        4289476462U,
                        3384657477U,
                        3059809510U,
                        2470391129U,
                        1382180475U,
                        583868312U,
                        3124509341U,
                        2611384329U,
                        3828001212U,
                        3427995755U,
                        1482645551U,
                        1979136598U,
                        2246410316U,
                        3417532141U,
                        403687328U,
                        983216273U,
                        2637975448U,
                        4040532932U,
                        881656030U,
                        586824519U,
                        1409025350U,
                        3192348893U,
                        1847179617U,
                        683484427U,
                        2102010476U,
                        2539604350U,
                        3958389627U,
                        4086048569U,
                        1054309643U,
                        694706176U,
                        1289730720U,
                        3039729614U,
                        1138530146U,
                        1606802895U,
                        243859408U,
                        2591963091U,
                        651757173U,
                        1272886739U,
                        482083209U,
                        3956301568U,
                        2573713819U,
                        2582443063U,
                        507131974U,
                        1523400251U,
                        1626447608U,
                        875588721U,
                        3479063855U,
                        758719931U,
                        1225734610U,
                        3190135309U,
                        3325204389U,
                        69688107U,
                        2383507464U,
                        2614023373U,
                        1862682631U,
                        4277245781U,
                        1947871390U,
                        123449838U,
                        2301105816U,
                        2361900179U,
                        4050451318U,
                        311560484U,
                        1616385175U,
                        2969389401U,
                        3815840819U,
                        1570354017U,
                        3647925715U,
                        1225390126U,
                        968496832U,
                        4024736042U,
                        3931738908U,
                        1736182379U,
                        1383696920U,
                        1738929315U,
                        2394823235U,
                        1054319481U,
                        1849153154U,
                        2810286272U,
                        4202271770U,
                        152080145U,
                        1947255745U,
                        2792860077U,
                        98709734U,
                        3439908311U,
                        1131009604U,
                        793064505U,
                        2509599254U,
                        1624554972U,
                        1581863366U,
                        2470770058U,
                        3894116516U,
                        736624011U,
                        2134233311U,
                        2735704100U,
                        2864025412U,
                        99085635U,
                        427383416U,
                        3302338713U,
                        2714822285U,
                        4145188981U,
                        1606108777U,
                        234939537U,
                        3654439227U,
                        3442164226U,
                        3862906500U,
                        2943310270U,
                        341870282U,
                        4285398104U,
                        1087164413U,
                        1922938559U,
                        670533313U,
                        2686536610U,
                        856049739U,
                        3549574063U,
                        950915033U,
                        2471632466U,
                        2700545017U,
                        3821109238U,
                        866536661U,
                        207194297U,
                        3178706388U,
                        1588767233U,
                        3238752503U,
                        3646856939U,
                        3652213339U,
                        3162633853U,
                        1532345878U,
                        2208664166U,
                        1222535833U,
                        4280112113U,
                        3881320950U,
                        3671131398U,
                        3959778204U,
                        4084157172U,
                        3059360582U,
                        1853093582U,
                        3943549459U,
                        2070585106U,
                        3674009395U,
                        2456961619U,
                        4014783519U,
                        2039817080U,
                        1065396468U,
                        1773362815U,
                        1646268397U,
                        2791002618U,
                        2870213686U,
                        1573884455U,
                        3843535316U,
                        825743484U,
                        1110752906U,
                        2235339646U,
                        477644550U,
                        368660397U,
                        3555576500U,
                        2072422653U,
                        1527780466U,
                        2143003174U,
                        1279942167U,
                        96163307U,
                        3207384578U,
                        795940085U,
                        1618768258U,
                        3083255758U,
                        2814646164U,
                        1202978489U,
                        2384959826U,
                        1608132886U,
                        1357683623U,
                        2215023839U,
                        592317291U,
                        3140714824U,
                        1110023481U,
                        1893125421U,
                        1371864208U,
                        2333201923U,
                        3077267727U,
                        2010929019U,
                        552100093U,
                        3500477406U,
                        1909580159U,
                        1574568711U,
                        3928551958U,
                        1044298190U,
                        344517260U,
                        3249716605U,
                        2722604575U,
                        664331872U,
                        2395567002U,
                        906000433U,
                        1655463595U,
                        3642414189U,
                        963567280U,
                        390538657U,
                        2732117051U,
                        3363013280U,
                        3643386095U,
                        4117745403U,
                        331833019U,
                        3091802546U,
                        356298374U,
                        2044216048U,
                        868251653U,
                        4137061990U,
                        3589961407U,
                        899657820U,
                        3653380823U,
                        2115538942U,
                        4020576718U,
                        1169516787U,
                        4011988117U,
                        2157796108U,
                        1898504606U,
                        4210128056U,
                        2214276477U,
                        4132023260U,
                        3457217266U,
                        86647201U,
                        1426020145U,
                        2107020924U,
                        1090185900U,
                        901268547U,
                        2518409489U,
                        2411554246U,
                        3808798291U,
                        93566716U,
                        3574903218U,
                        446653068U,
                        72290872U,
                        838984496U,
                        2194717497U,
                        3593934011U,
                        2729196331U,
                        4085011108U,
                        3645805968U,
                        3962815236U,
                        372455150U,
                        3072936643U,
                        1843929782U,
                        3550150746U,
                        2389822604U,
                        3426918289U,
                        2631265660U,
                        4013039574U,
                        1702065974U,
                        3132377903U,
                        3173794582U,
                        2638633033U,
                        691401738U,
                        1122817257U,
                        2991199864U,
                        3566209238U,
                        3816249856U,
                        507032049U,
                        3142413769U,
                        1575100745U,
                        2117934411U,
                        3248896872U,
                        4216489987U,
                        4290203271U,
                        4257511129U,
                        2227208693U,
                        2597281528U,
                        1498483828U,
                        2932094512U,
                        4185679017U,
                        2387174227U,
                        2202766925U,
                        542238383U,
                        917525535U,
                        1209831471U,
                        466254820U,
                        2500293336U,
                        2597010924U,
                        1463375909U,
                        252072612U,
                        3939134939U,
                        182963165U,
                        197416066U,
                        68209537U,
                        1062791395U,
                        871883329U,
                        1061279900U,
                        1046301453U,
                        651975361U,
                        1572773422U,
                        2900716948U,
                        2930756844U,
                        3590338517U,
                        3413414893U,
                        2851230529U,
                        619348952U,
                        3830793576U,
                        3675592511U,
                        58106121U,
                        1678180665U,
                        2431773194U,
                        326970667U,
                        3264100027U,
                        1015373177U,
                        1207141605U,
                        2037608801U,
                        1348372020U,
                        3037358022U,
                        289190943U,
                        2091515742U,
                        4093844103U,
                        553492146U,
                        3797330099U,
                        365343600U,
                        2228269674U,
                        2718087326U,
                        3923943483U,
                        2767880964U,
                        1019136841U,
                        1605410128U,
                        1475123012U,
                        3474407824U,
                        2594619993U,
                        2882630738U,
                        737212509U,
                        851666865U,
                        4053834345U,
                        8604487U,
                        256870491U,
                        608405201U,
                        1941003560U,
                        1603578123U,
                        337098870U,
                        2052077177U,
                        2791053499U,
                        322533828U,
                        3756016070U,
                        3284784595U,
                        2177338243U,
                        4092759302U,
                        290703471U,
                        128012770U,
                        3845186507U,
                        831565593U,
                        3069715633U,
                        159009876U,
                        1838591102U,
                        3062297721U,
                        1854709703U,
                        703865846U,
                        3062085027U,
                        1171729402U,
                        3343639479U,
                        669448109U,
                        2022803351U,
                        1019480614U,
                        1822644170U,
                        2937177450U,
                        3558225440U,
                        1258646574U,
                        415247852U,
                        1018932258U,
                        2952470049U,
                        973464683U,
                        817738015U,
                        326403426U,
                        1495938465U,
                        1049518208U,
                        1552729082U,
                        2146627074U,
                        31691801U,
                        3601491217U,
                        244218253U,
                        3963864281U,
                        3057730285U,
                        3467524529U,
                        855213078U,
                        3097040456U,
                        199587546U,
                        424827498U,
                        278132912U,
                        3615160203U,
                        3146205108U,
                        2277239478U,
                        1522991273U,
                        1025525994U,
                        2101470572U,
                        1299884896U,
                        4255367686U,
                        359375326U,
                        2968119664U,
                        4261175196U,
                        35621701U,
                        829624047U,
                        1324769020U,
                        84781187U,
                        159141573U,
                        3462934773U,
                        1743665716U,
                        1030988927U,
                        1253796854U,
                        4174921738U,
                        1520191078U,
                        2505122121U,
                        4225554024U,
                        2592693061U,
                        3515097977U,
                        3703399066U,
                        92046314U,
                        695383595U,
                        1608659192U,
                        3454360453U,
                        2856472208U,
                        3239879246U,
                        168287638U,
                        2326024683U,
                        2692039183U,
                        483538061U,
                        672648507U,
                        252502717U,
                        2953208498U,
                        2379613762U,
                        3345071871U,
                        3988042451U,
                        1926230026U,
                        2685892001U,
                        993974702U,
                        1822005890U,
                        3454494383U,
                        4036034783U,
                        1866073417U,
                        1634312638U,
                        2689671829U,
                        2101209106U,
                        3749598396U,
                        349616425U,
                        1590456654U,
                        1759833389U,
                        2873988592U,
                        3989103015U,
                        3272217501U,
                        1995686390U,
                        460255378U,
                        3014136117U,
                        288176594U,
                        1755772294U,
                        3711777280U,
                        1456210996U,
                        1986238895U,
                        3634691549U,
                        1986449819U,
                        3108854795U,
                        401506269U,
                        986811883U,
                        1171567997U,
                        2776142859U,
                        888014876U,
                        2942919395U,
                        2924254627U,
                        1215121131U,
                        699490143U,
                        3392928996U,
                        548923206U,
                        3284210208U,
                        93947393U,
                        4169234824U,
                        3020374004U,
                        1135741136U,
                        3463955461U,
                        2031190622U,
                        2609317696U,
                        3160292523U,
                        2326117030U,
                        2582023972U,
                        2720048283U,
                        88632876U,
                        3720276003U,
                        3036922674U,
                        214793511U,
                        980637051U,
                        1856247953U,
                        2308753008U,
                        1104805384U,
                        1487933203U,
                        1415076293U,
                        3157108169U,
                        1672891463U,
                        19698099U,
                        3277321645U,
                        670214553U,
                        1179168415U,
                        1116508043U,
                        2328040123U,
                        2413703472U,
                        4274966267U,
                        894200788U,
                        4039657221U,
                        3476251134U,
                        2141592140U,
                        1315156580U,
                        4111735289U,
                        2901557752U,
                        232752201U,
                        3777175717U,
                        2216134758U,
                        1118905351U,
                        246654837U,
                        3402275726U,
                        2220686390U,
                        1924846180U,
                        2132749714U,
                        3851952299U,
                        527519952U,
                        2604318587U,
                        4099690121U,
                        32715550U,
                        3439972336U,
                        2503524622U,
                        3676775523U,
                        3503119946U,
                        2595328626U,
                        3419834024U,
                        520390555U,
                        3599573761U,
                        4080104986U,
                        2545382067U,
                        1789025176U,
                        2337888660U,
                        1949120413U,
                        3764702428U,
                        3280265549U,
                        2012296640U,
                        22784337U,
                        931537743U,
                        294511416U,
                        2471879620U,
                        1502899488U,
                        1880998344U,
                        987784703U,
                        1033148095U,
                        475699751U,
                        1995525746U,
                        2184401593U,
                        1663011995U,
                        2064933464U,
                        334775092U,
                        4105723830U,
                        2623043850U,
                        2363057858U,
                        3460700131U,
                        4022475860U,
                        406062576U,
                        2671091285U,
                        3638660904U,
                        2749112273U,
                        634889288U,
                        3923382441U,
                        192119765U,
                        1118817264U,
                        1210149363U,
                        4119659199U,
                        1266829534U,
                        3456598379U,
                        3231373419U,
                        2692255353U,
                        3538031404U,
                        1776924591U,
                        4137234941U,
                        3480630750U,
                    });
            }
        }
    }
}
